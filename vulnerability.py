from flask import Flask, request
import sqlite3
import os

app = Flask(__name__)

# ⚠️ 1. Hardcoded credentials (info disclosure)
ADMIN_PASSWORD = "supersecret123"

# ⚠️ 2. Insecure database setup
conn = sqlite3.connect('users.db')
cursor = conn.cursor()
cursor.execute("CREATE TABLE IF NOT EXISTS users (username TEXT, password TEXT)")
conn.commit()

@app.route('/login', methods=['POST'])
def login():
    username = request.form['username']
    password = request.form['password']

    # ⚠️ 3. SQL Injection vulnerability
    query = f"SELECT * FROM users WHERE username = '{username}' AND password = '{password}'"
    result = cursor.execute(query).fetchone()

    if result:
        return "Login successful!"
    else:
        return "Invalid credentials"

@app.route('/upload', methods=['POST'])
def upload():
    file = request.files['file']
    
    # ⚠️ 4. Path Traversal vulnerability
    save_path = os.path.join("uploads", file.filename)
    file.save(save_path)

    return f"Saved to {save_path}"

@app.route('/run', methods=['POST'])
def run():
    cmd = request.form['cmd']

    # ⚠️ 5. Command Injection vulnerability
    os.system(f"echo Running command: {
